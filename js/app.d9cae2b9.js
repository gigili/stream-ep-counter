(function(e){function t(t){for(var o,a,i=t[0],s=t[1],u=t[2],d=0,f=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&f.push(c[a][0]),c[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,i=1;i<n.length;i++){var s=n[i];0!==c[s]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},c={app:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1:function(e,t){},2:function(e,t){},"3f78":function(e,t,n){"use strict";n("d36d")},"6df6":function(e,t,n){"use strict";n("b349")},"9cdc":function(e,t,n){"use strict";n("c701")},b349:function(e,t,n){},b3b1:function(e,t,n){"use strict";n("ecbb")},c701:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),c={key:0},r={key:1},a={class:"flex-holder"},i={class:"column"},s={class:"scrolling-holder "},u={class:"nes-container is-rounded is-dark with-title"},l=Object(o["f"])("p",{class:"title"},"Stream Topics",-1),d={class:"scrolling-content"},f={class:"nes-container is-rounded is-dark"},p={class:"column"},b={key:0,class:"nes-container is-rounded is-dark with-title"},h=Object(o["f"])("p",{class:"title"},"New Topic",-1),m={key:1,class:"nes-container is-rounded is-dark with-title"},g={class:"title"},O={key:2,class:"nes-container is-rounded is-dark with-title"},j=Object(o["f"])("p",{class:"title"},"Changed history:",-1),v={key:3,class:"nes-container is-rounded is-dark with-title"},w=Object(o["f"])("p",{class:"title"},"Options:",-1);function k(e,t,n,k,y,T){var I=Object(o["p"])("topic-entry"),C=Object(o["p"])("topic-form"),x=Object(o["p"])("closable-panel"),S=Object(o["p"])("history-list"),_=Object(o["p"])("options-vue");return e.authRedirectMode?(Object(o["h"])(),Object(o["c"])("div",c," HI, You were authenticated, this window will close in 4 Seconds :) ")):(Object(o["h"])(),Object(o["c"])("div",r,[Object(o["f"])("a",{class:"github-link",href:"https://github.com/negue/stream-ep-counter",target:"_blank",rel:"noopener",onMouseover:t[1]||(t[1]=function(t){return e.startAnimate=!0}),onMouseout:t[2]||(t[2]=function(t){return e.startAnimate=!1})},[Object(o["f"])("i",{class:["nes-octocat",e.startAnimate?"animate":""]},null,2)],32),Object(o["f"])("div",a,[Object(o["f"])("div",i,[Object(o["f"])("div",s,[Object(o["f"])("div",u,[l,Object(o["f"])("div",null,[Object(o["f"])("button",{type:"button",class:"nes-btn is-primary",onClick:t[3]||(t[3]=function(t){return e.showNewForm=!e.showNewForm})}," Add new topic "),Object(o["f"])("button",{type:"button",class:"nes-btn is-primary",onClick:t[4]||(t[4]=function(t){return e.showHistory=!e.showHistory})}," Toggle History "),Object(o["f"])("button",{type:"button",class:"nes-btn is-primary",onClick:t[5]||(t[5]=function(t){return e.showOptions=!e.showOptions})}," Toggle Options "),e.loggedIn?Object(o["d"])("",!0):(Object(o["h"])(),Object(o["c"])("button",{key:0,onClick:t[6]||(t[6]=function(t){return e.getToken()}),class:"nes-btn is-success"},"Twitch Auth")),e.loggedIn?(Object(o["h"])(),Object(o["c"])("button",{key:1,onClick:t[7]||(t[7]=function(t){return e.logout()}),class:"nes-btn is-error"},"Logout: "+Object(o["q"])(e.userName),1)):Object(o["d"])("",!0)])]),Object(o["f"])("div",d,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(e.state.topics,(function(n){return Object(o["h"])(),Object(o["c"])("div",{key:n.id},[Object(o["f"])("div",f,[Object(o["f"])("div",null,[Object(o["f"])(I,{topic:n,loggedIn:e.loggedIn,onShowEditForm:t[8]||(t[8]=function(t){return e.showEditForm(t)}),onDeleteTopic:t[9]||(t[9]=function(t){return e.deleteTopic(t)}),onIncreaseCounter:t[10]||(t[10]=function(t){return e.increaseCounter(t)}),onSetupTwitch:t[11]||(t[11]=function(t){return e.setupTwitch(t)})},null,8,["topic","loggedIn"])])])])})),128))])])]),Object(o["f"])("div",p,[e.showNewForm?(Object(o["h"])(),Object(o["c"])("div",b,[h,Object(o["f"])(x,{onCancel:t[13]||(t[13]=function(t){return e.showNewForm=!1})},{default:Object(o["u"])((function(){return[Object(o["f"])(C,{onSave:e.onAddNew,onCancel:t[12]||(t[12]=function(t){return e.showNewForm=!1}),loggedIn:e.loggedIn},null,8,["onSave","loggedIn"])]})),_:1})])):Object(o["d"])("",!0),e.formForTopic?(Object(o["h"])(),Object(o["c"])("div",m,[Object(o["f"])("p",g,"Edit Topic: "+Object(o["q"])(e.formForTopic.title),1),Object(o["f"])(x,{onCancel:t[15]||(t[15]=function(t){return e.formForTopic=void 0})},{default:Object(o["u"])((function(){return[Object(o["f"])(C,{topic:e.formForTopic,onSave:e.editTopic,onCancel:t[14]||(t[14]=function(t){return e.formForTopic=void 0}),loggedIn:e.loggedIn},null,8,["topic","onSave","loggedIn"])]})),_:1})])):Object(o["d"])("",!0),e.showHistory?(Object(o["h"])(),Object(o["c"])("div",O,[j,Object(o["f"])(x,{onCancel:t[16]||(t[16]=function(t){return e.showHistory=!1})},{default:Object(o["u"])((function(){return[Object(o["f"])(S)]})),_:1})])):Object(o["d"])("",!0),e.showOptions?(Object(o["h"])(),Object(o["c"])("div",v,[w,Object(o["f"])(x,{onCancel:t[18]||(t[18]=function(t){return e.showOptions=!1})},{default:Object(o["u"])((function(){return[Object(o["f"])(_,{onCancel:t[17]||(t[17]=function(t){return e.showOptions=!1})})]})),_:1})])):Object(o["d"])("",!0)])])]))}n("99af"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d");var y,T=n("b85c"),I=n("5530"),C=(n("96cf"),n("1da1")),x=n("d4ec"),S=n("bee2"),_=n("262e"),N=n("2caf"),A=n("9ab4"),R=n("ce1f"),U=(n("c740"),n("c975"),n("a15b"),n("d81d"),n("a434"),n("ade3")),F="{name}",q="{content}",P="commandSyntax",E=Object(U["a"])({},P,null!==(y=localStorage.getItem(P))&&void 0!==y?y:"!editcommand ".concat(F," ").concat(q)),D={currentCounter:1,title:"",template:"",tags:"",commands:[],commandsJson:"[]",customChannel:""},H={task:"",lastCounter:0,topicId:-1,lastTitle:""},L=n("257e"),V=n("4dec"),B=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){var e;Object(x["a"])(this,n),e=t.call(this,"StreamEpCounter");var o=Object(L["a"])(e);return o.version(5).stores({topics:"++id, currentCounter, title, template, gameId, gameName, tags, commandsJson",history:"++id, date, task",tags:"id, name"}),e}return n}(V["a"]),J=new B,$={state:Object(o["l"])({topics:[],history:[],tags:{}}),loadDataFromDb:function(){J.topics.toArray().then((function(e){var t,n=Object(T["a"])(e);try{for(n.s();!(t=n.n()).done;){var o,c=t.value;c.commands=JSON.parse(null!==(o=c.commandsJson)&&void 0!==o?o:"[]")}}catch(r){n.e(r)}finally{n.f()}$.state.topics=e})),J.history.toArray().then((function(e){$.state.history=e})),J.tags.toArray().then((function(e){var t,n=Object(T["a"])(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;$.state.tags[o.id]=o}}catch(c){n.e(c)}finally{n.f()}}))},addTopic:function(e){var t=Object.assign({},D,e),n=t.commands;t.commandsJson=JSON.stringify(t.commands),delete t.commands,this.importTagsAndUpdateTagIdList(t),this.state.topics.push(t),console.info("pre calling topic add"),J.topics.add(t),t.commands=n},deleteTopic:function(e){var t=this.state.topics.indexOf(e);-1!==t&&this.state.topics.splice(t,1),J.topics.delete(e.id)},editTopic:function(e){var t=this.state.topics.findIndex((function(t){return t.id===e.id})),n=Object.assign({},e),o=n.commands;n.commandsJson=JSON.stringify(n.commands),delete n.commands,this.importTagsAndUpdateTagIdList(n),-1!==t&&(this.state.topics[t]=n,console.info("updated in state?!",this.state)),console.info("pre calling topic update"),J.topics.update(e.id,n),n.commands=o},addHistoryEntry:function(e){var t=Object.assign({date:new Date},H,e);this.state.history.push(t),J.history.add(t)},importTagsAndUpdateTagIdList:function(e){var t,n;e.importTags&&(this.importUnknownTags(e.importTags),e.tags=null!==(t=null===(n=e.importTags)||void 0===n?void 0:n.map((function(e){return e.id})).join(","))&&void 0!==t?t:"",delete e.importTags)},importUnknownTags:function(e){var t,n=Object(T["a"])(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(!this.state.tags[o.id]){this.state.tags[o.id]=o;var c=Object.assign({},o);console.info("PRE adding a tag",o),J.tags.add(c)}}}catch(r){n.e(r)}finally{n.f()}}};$.loadDataFromDb();n("caad"),n("fb6a"),n("b0c0"),n("2532");var z=Object(o["y"])("data-v-0065ee49");Object(o["k"])("data-v-0065ee49");var M={class:"form-holder topic-form"},X={class:"nes-field"},Y=Object(o["f"])("label",{for:"name_field"}," Topic ",-1),G={class:"nes-field"},W=Object(o["f"])("span",null,"Custom Channel",-1),K={class:"nes-field"},Q=Object(o["f"])("label",{for:"counter_field"},"Counter",-1),Z={class:"nes-field"},ee=Object(o["f"])("label",{for:"textarea_field"},"Title-Template",-1),te={key:0},ne=Object(o["e"])("You need to use "),oe=Object(o["e"])(" as placeholder. "),ce={key:1,class:"nes-text is-error"},re={class:"nes-field"},ae=Object(o["f"])("label",null,"In Twitch Overview",-1),ie={class:"nes-text is-warning"},se={class:"nes-field"},ue=Object(o["f"])("label",null,"Tags",-1),le={class:"nes-field"},de=Object(o["e"])(" Commands "),fe=Object(o["f"])("br",null,null,-1),pe=Object(o["f"])("br",null,null,-1),be={key:0},he=Object(o["f"])("br",null,null,-1),me=Object(o["f"])("br",null,null,-1),ge=Object(o["f"])("br",null,null,-1),Oe=Object(o["f"])("br",null,null,-1),je=Object(o["f"])("br",null,null,-1),ve=Object(o["f"])("br",null,null,-1);Object(o["i"])();var we=z((function(e,t,n,c,r,a){var i,s=Object(o["p"])("tags-input");return Object(o["h"])(),Object(o["c"])("div",M,[Object(o["f"])("div",X,[Y,Object(o["v"])(Object(o["f"])("input",{type:"text",id:"name_field",class:["nes-input",{"is-error":!e.workingTopic.title}],required:!e.workingTopic.title,autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.workingTopic.title=t})},null,10,["required"]),[[o["s"],e.workingTopic.title]])]),Object(o["f"])("div",G,[Object(o["f"])("label",null,[Object(o["v"])(Object(o["f"])("input",{type:"checkbox",class:"nes-checkbox is-dark","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.customChannel=t})},null,512),[[o["r"],e.customChannel]]),W]),e.customChannel?Object(o["v"])((Object(o["h"])(),Object(o["c"])("input",{key:0,type:"text",class:["nes-input",{"is-error":e.customChannel&&!e.workingTopic.customChannel,"is-disabled":!e.customChannel}],required:!e.workingTopic.customChannel,disabled:!e.customChannel,autocomplete:"off","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.workingTopic.customChannel=t})},null,10,["required","disabled"])),[[o["s"],e.workingTopic.customChannel]]):Object(o["d"])("",!0)]),Object(o["f"])("div",K,[Q,Object(o["v"])(Object(o["f"])("input",{type:"number",id:"counter_field",class:"nes-input",autocomplete:"off","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.workingTopic.currentCounter=t})},null,512),[[o["s"],e.workingTopic.currentCounter]])]),Object(o["f"])("div",Z,[ee,Object(o["v"])(Object(o["f"])("textarea",{id:"textarea_field",class:"nes-textarea","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.workingTopic.template=t})},null,512),[[o["s"],e.workingTopic.template]]),(null===(i=e.workingTopic.template)||void 0===i?void 0:i.includes("{{counter}}"))?Object(o["d"])("",!0):(Object(o["h"])(),Object(o["c"])("div",te,[Object(o["f"])("i",null,[ne,Object(o["f"])("code",null,Object(o["q"])(e.counterPlaceholder),1),oe])])),e.isTemplateInvalid?(Object(o["h"])(),Object(o["c"])("span",ce,Object(o["q"])(e.notValidExplanation),1)):Object(o["d"])("",!0)]),Object(o["f"])("div",re,[ae,Object(o["f"])("span",ie,Object(o["q"])(e.generatedTitle.slice(0,32)),1)]),Object(o["f"])("div",se,[ue,Object(o["f"])(s,{"element-id":"tags",ref:"tagsInput",value:e.currentTags,onTagsUpdated:t[6]||(t[6]=function(t){return e.updateTags(t)}),"only-existing-tags":!0,"id-field":"id","text-field":"name","existing-tags":e.allTags,typeahead:!0,placeholder:"Select tags","typeahead-activation-threshold":0},{"selected-tag":z((function(e){var t=e.tag,n=e.index,c=e.removeTag;return[Object(o["e"])(Object(o["q"])(t.name)+" ",1),Object(o["f"])("span",{class:"is-danger",onClick:Object(o["x"])((function(e){return c(n)}),["prevent"])},"X",8,["onClick"])]})),_:1},8,["value","existing-tags"])]),Object(o["f"])("div",le,[Object(o["f"])("label",null,[de,Object(o["f"])("button",{type:"button",class:"nes-btn",onClick:t[7]||(t[7]=function(t){return e.addCommand()})},"Add new command")]),(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(e.workingTopic.commands,(function(t,n){return Object(o["h"])(),Object(o["c"])("div",{key:n,class:"command_item"},[Object(o["v"])(Object(o["f"])("input",{type:"text",class:"nes-input",autocomplete:"off","onUpdate:modelValue":function(e){return t.name=e}},null,8,["onUpdate:modelValue"]),[[o["s"],t.name]]),Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:function(t){return e.removeCommand(n)}},"X",8,["onClick"]),fe,Object(o["v"])(Object(o["f"])("textarea",{class:"nes-textarea","onUpdate:modelValue":function(e){return t.content=e}},null,8,["onUpdate:modelValue"]),[[o["s"],t.content]])])})),128))]),pe,e.workingTopic.gameName||e.workingTopic.tags?(Object(o["h"])(),Object(o["c"])("div",be,[he,Object(o["e"])(" Game: "+Object(o["q"])(e.workingTopic.gameName)+" ",1),me,ge])):Object(o["d"])("",!0),Oe,Object(o["f"])("button",{type:"button",class:["nes-btn",{"is-is-error":e.loggedIn,"is-disabled":!e.loggedIn}],onClick:t[8]||(t[8]=function(t){return e.importFromTwitch()})},"Import from Twitch",2),je,ve,Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:t[9]||(t[9]=function(t){return e.cancel()})},"Cancel"),Object(o["f"])("button",{type:"button",class:"nes-btn",onClick:t[10]||(t[10]=function(t){return e.save()})},"Save")])})),ke=(n("4de4"),n("07ac"),n("1276"),n("2909"));n("841c"),n("4c53");function ye(e){return e&&e.template?e.template.replace(/{{counter}}/g,"".concat(e.currentCounter)):""}function Te(e){var t=E[P].replace(F,e.name).replace(q,e.content);return t}var Ie=n("1232"),Ce=n("3cba"),xe="userId",Se="userName",_e="tokenId",Ne="accessToken",Ae=function(){function e(t,n,o){Object(x["a"])(this,e),this.clientId=t,this.scopes=n,this.redirectUrl=o,this.twitchAuthUrl="https://id.twitch.tv/oauth2/authorize?response_type=token%20id_token&client_id=".concat(this.clientId,"&redirect_uri=").concat(encodeURIComponent(this.redirectUrl),"&scope=").concat(this.scopes,"+openid"),this.tmi=null}return Object(S["a"])(e,[{key:"login",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o,c=null!==(o=localStorage.getItem(xe))&&void 0!==o?o:"";if(c){var r,a,i,s=null!==(r=localStorage.getItem(Se))&&void 0!==r?r:"",u=null!==(a=localStorage.getItem(_e))&&void 0!==a?a:"",l=null!==(i=localStorage.getItem(Ne))&&void 0!==i?i:"";e({userId:c,userName:s,tokenId:u,accessToken:l})}else window.open(t.twitchAuthUrl,"Twitch Auth","toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0"),console.info(t.twitchAuthUrl),window.gotToken=function(t,n,o,c){console.info({userName:t,userId:n,tokenId:o,accessToken:c}),e({userName:t,userId:n,tokenId:o,accessToken:c}),localStorage.setItem(Se,t),localStorage.setItem(xe,n),localStorage.setItem(_e,o),localStorage.setItem(Ne,c)}})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loginExists",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(Ne),t){e.next=3;break}return e.abrupt("return",null);case 3:return e.abrupt("return",fetch("https://id.twitch.tv/oauth2/userinfo",{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){return console.info({js:e}),e})));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkTokens",value:function(){console.info({location:location});var e=location.hash.replace("#",""),t=new URLSearchParams(e),n=t.get("id_token"),o=t.get("access_token"),c=Object(Ie["a"])(n);console.info({jwt:c});var r=c.preferred_username,a=c.sub;console.info({userName:r,userId:a,tokenId:n,accessToken:o}),setTimeout((function(){window.opener.gotToken(r,a,n,o),window.close()}),4e3)}},{key:"currentChannelInformation",value:function(){return fetch("https://api.twitch.tv/helix/channels?broadcaster_id="+localStorage.getItem(xe),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId}}).then((function(e){return e.json()})).then((function(e){return console.info({js:e}),e.data[0]}))}},{key:"getChannelInfoByUserName",value:function(e){return fetch("https://api.twitch.tv/helix/users?login="+e,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId}}).then((function(e){return e.json()})).then((function(e){return console.info({js:e}),e.data[0]}))}},{key:"currentTags",value:function(){return fetch("https://api.twitch.tv/helix/streams/tags?broadcaster_id="+localStorage.getItem(xe),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId}}).then((function(e){return e.json()})).then((function(e){return console.info({js:e}),e.data}))}},{key:"applyTopicToTwitch",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(t){var n,o,c,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=localStorage.getItem(xe),c={tag_ids:null===(n=t.tags)||void 0===n?void 0:n.split(",").filter((function(e){return""!==e}))},!t.customChannel){e.next=8;break}return e.next=5,this.getChannelInfoByUserName(t.customChannel);case 5:r=e.sent,console.info({result:r}),o=r.id;case 8:if(0===c.tag_ids.length){e.next=12;break}return e.next=11,fetch("https://api.twitch.tv/helix/streams/tags?broadcaster_id="+o,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId,"content-type":"application/json"},method:"PUT",body:JSON.stringify(c)});case 11:console.info("Sent Tags");case 12:return a={game_id:t.gameId,title:ye(t),broadcaster_language:"en"},e.next=15,fetch("https://api.twitch.tv/helix/channels?broadcaster_id="+o,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId,"content-type":"application/json"},method:"PATCH",body:JSON.stringify(a)});case 15:console.info("Apply values to Twitch",{broadcaster_id:o,newTagsPayload:c,channelInformationPayload:a});case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"writeToChat",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(t){var n,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=null!==(n=localStorage.getItem("userName"))&&void 0!==n?n:"",null!==this.tmi){e.next=7;break}return this.tmi=Ce["Client"]({identity:{username:o,password:"oauth:".concat(localStorage.getItem("accessToken"))},connection:{secure:!0,reconnect:!0}}),e.next=5,this.tmi.connect();case 5:c=e.sent,console.info({result:c,userName:o});case 7:return e.next=9,this.tmi.say(o,Te(t));case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"resetAuth",value:function(){localStorage.setItem(xe,""),localStorage.setItem(Se,""),localStorage.setItem(_e,""),localStorage.setItem(Ne,"")}}]),e}(),Re=function(){function e(){Object(x["a"])(this,e)}return Object(S["a"])(e,[{key:"login",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{accessToken:"",tokenId:"",userName:"",userId:""});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loginExists",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{preferred_username:"offfline",message:"",status:200});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkTokens",value:function(){}},{key:"currentChannelInformation",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{title:"Stuff",game_id:"1334",game_name:"Coding Stuff"});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"currentTags",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"applyTopicToTwitch",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:alert("Stuff will be applied to Twitch");case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"writeToChat",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:alert("Writing to chat that!"+Te(t));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"resetAuth",value:function(){alert()}}]),e}(),Ue="".concat(location.href),Fe="user_read+user:edit:broadcast+chat:read+chat:edit",qe="mz7t3tiaptc51q5rvp5e86j51e61p5",Pe=new URLSearchParams(location.search);console.info({queryParams:Pe});var Ee=Pe.has("develop")?new Re:new Ae(qe,Fe,Ue),De=n("0b72"),He=Object(o["g"])({components:{TagsInput:De["a"]},props:{topic:{type:Object,required:!0},loggedIn:{type:Boolean}},data:function(){var e;return{workingTopic:Object(I["a"])({},this.topic),counterPlaceholder:"{{counter}}",currentTags:[],state:$.state,customChannel:!!(null===(e=this.topic)||void 0===e?void 0:e.customChannel)}},computed:{allTags:function(){var e,t=Object(ke["a"])(Object.values(this.state.tags));return(null===(e=this.workingTopic)||void 0===e?void 0:e.importTags)&&t.push.apply(t,Object(ke["a"])(this.workingTopic.importTags)),t},generatedTitle:function(){return ye(Object(I["a"])({},this.workingTopic))},isTemplateInvalid:function(){return""!==this.notValidExplanation},notValidExplanation:function(){var e=this.workingTopic.template;if(!e)return"You need a template.";var t=ye(Object(I["a"])(Object(I["a"])({},this.workingTopic),{},{currentCounter:100})),n=t.length;return n>140?"A generated topic can be only 140 characters long. (Using 100 as counter) - Current Length: ".concat(n):""}},methods:{cancel:function(){this.$emit("cancel")},save:function(){this.workingTopic.title&&(this.isTemplateInvalid||this.$emit("save",this.workingTopic))},importFromTwitch:function(){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function t(){var n,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ee.currentChannelInformation();case 2:return n=t.sent,t.next=5,Ee.currentTags();case 5:o=t.sent,e.workingTopic.template||(e.workingTopic.template=n.title),e.workingTopic.gameId=n.game_id,e.workingTopic.gameName=n.game_name,console.info({channelInfo:n,tags:o}),c=o.filter((function(e){return!e.is_auto})).map((function(e){return{id:e.tag_id,name:e.localization_names["en-us"]}})),console.info({tags:o,importedTags:c}),e.workingTopic.importTags=c,e.currentTags=c;case 14:case"end":return t.stop()}}),t)})))()},updateTagsFromTopic:function(){var e,t,n,o=this;console.info({topic:this.workingTopic,state:null!==(e=JSON.stringify(this.state.tags))&&void 0!==e?e:"no null value",test:!0}),this.currentTags=null!==(t=null===(n=this.workingTopic.tags)||void 0===n?void 0:n.split(",").map((function(e){return o.state.tags[e]})).filter((function(e){return!!e})))&&void 0!==t?t:[],this.updateTagsToTopic()},updateTags:function(){var e=this.$refs.tagsInput.tags;this.currentTags=e,console.info(this.$refs),console.info("SHOULD BE UPDATED?!!?",this.currentTags),this.updateTagsToTopic()},updateTagsToTopic:function(){this.workingTopic.tags=this.currentTags.map((function(e){return e.id})).join(",")},addCommand:function(){this.workingTopic.commands.push({name:"New Command",content:""})},removeCommand:function(e){this.workingTopic.commands.splice(e,1)}},watch:{topic:function(e){this.workingTopic=Object(I["a"])({},e),this.updateTagsFromTopic()}},mounted:function(){this.updateTagsFromTopic()}});n("3f78"),n("6df6");He.render=we,He.__scopeId="data-v-0065ee49";var Le=He,Ve=Object(o["y"])("data-v-203cd942");Object(o["k"])("data-v-203cd942");var Be={class:"panel-holder"};Object(o["i"])();var Je=Ve((function(e,t,n,c,r,a){return Object(o["h"])(),Object(o["c"])("div",Be,[Object(o["o"])(e.$slots,"default"),Object(o["f"])("button",{type:"button",class:"nes-btn is-error floating-close-button",onClick:t[1]||(t[1]=function(e){return a.cancel()})},"X")])})),$e={name:"ClosablePanel",methods:{cancel:function(){this.$emit("cancel")}}};n("b3b1");$e.render=Je,$e.__scopeId="data-v-203cd942";var ze=$e,Me=Object(o["y"])("data-v-19254a70");Object(o["k"])("data-v-19254a70");var Xe={key:0},Ye={class:"nes-text is-warning"},Ge=Object(o["f"])("br",null,null,-1),We=Object(o["f"])("br",null,null,-1),Ke=Object(o["f"])("br",null,null,-1),Qe=Object(o["e"])(" Tags: "),Ze={key:0},et={class:"is-primary"},tt={key:1},nt=Object(o["f"])("br",null,null,-1),ot=Object(o["f"])("br",null,null,-1),ct={class:"nes-text is-success"},rt=Object(o["e"])(),at=Object(o["f"])("br",null,null,-1);Object(o["i"])();var it=Me((function(e,t,n,c,r,a){var i,s;return Object(o["h"])(),Object(o["c"])(o["a"],null,[Object(o["f"])("h4",null,[Object(o["e"])(Object(o["q"])(e.topic.title)+" ["+Object(o["q"])(e.topic.currentCounter)+"] ",1),Object(o["f"])("button",{type:"button",class:"nes-btn is-warning",onClick:t[1]||(t[1]=function(t){return e.$emit("show-edit-form",e.topic)})},"Edit"),Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:t[2]||(t[2]=function(t){return e.$emit("delete-topic",e.topic)})},"X"),e.topic.customChannel?(Object(o["h"])(),Object(o["c"])("span",Xe," @"+Object(o["q"])(e.topic.customChannel),1)):Object(o["d"])("",!0)]),Object(o["f"])("h5",null,[Object(o["f"])("span",Ye,Object(o["q"])(e.generateTitle(e.topic).slice(0,32)),1),Object(o["e"])(Object(o["q"])(e.generateTitle(e.topic).slice(32))+" ",1),Ge]),We,Object(o["e"])(" Game: "+Object(o["q"])(null!==(i=e.topic.gameName)&&void 0!==i?i:'Need to "Import from Twitch"')+" ",1),Ke,Qe,e.topic.tags?(Object(o["h"])(),Object(o["c"])("span",Ze,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(null===(s=e.topic.tags)||void 0===s?void 0:s.split(",").map((function(t){var n;return null===(n=e.state.tags[t])||void 0===n?void 0:n.name})),(function(e){return Object(o["h"])(),Object(o["c"])("span",{class:"nes-badge",key:e},[Object(o["f"])("span",et,Object(o["q"])(e),1)])})),128))])):Object(o["d"])("",!0),e.topic.tags?Object(o["d"])("",!0):(Object(o["h"])(),Object(o["c"])("span",tt,' Need to "Import from Twitch" ')),nt,ot,Object(o["f"])("span",ct,Object(o["q"])(e.lastAppliedLabel),1),rt,at,Object(o["f"])("button",{type:"button",class:"nes-btn is-warning",onClick:t[3]||(t[3]=function(t){return e.$emit("increase-counter",e.topic)})},"Increase Counter"),Object(o["f"])("button",{type:"button",class:["nes-btn",{"is-success":e.loggedIn,"is-disabled":!e.loggedIn}],onClick:t[4]||(t[4]=function(t){return e.$emit("setup-twitch",e.topic)})},"Set Twitch Title & Tags",2)],64)})),st=(n("a9e3"),Object(o["g"])({props:{topic:{type:Object,required:!0},loggedIn:{type:Boolean}},data:function(){return{state:$.state}},computed:{lastAppliedLabel:function(){var e=this,t=this.state.history.filter((function(t){return t.topicId===e.topic.id}));if(t.length>0){t.sort((function(e,t){return e.date&&t.date?Number(new Date(t.date))-Number(new Date(e.date)):0}));var n=t[0];return"".concat(new Date(n.date).toLocaleString()," with the Title:  ").concat(n.lastTitle)}return console.info({foundEntriesInHistory:t}),""}},methods:{generateTitle:function(e){return ye(e)}}}));st.render=it,st.__scopeId="data-v-19254a70";var ut=st,lt=Object(o["y"])("data-v-23929ce5");Object(o["k"])("data-v-23929ce5");var dt={key:0};Object(o["i"])();var ft=lt((function(e,t,n,c,r,a){return Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(e.sortedHistory,(function(e,t){return Object(o["h"])(),Object(o["c"])("div",{key:e.id},[0!==t?(Object(o["h"])(),Object(o["c"])("hr",dt)):Object(o["d"])("",!0),Object(o["f"])("h4",null,Object(o["q"])(e.task),1),Object(o["e"])(" "+Object(o["q"])(new Date(e.date).toLocaleString()),1)])})),128)})),pt=(n("25f0"),Object(o["g"])({data:function(){return{state:$.state}},computed:{sortedHistory:function(){var e=Object(ke["a"])(this.state.history);return e.sort((function(e,t){var n=Date.parse(e.date.toString()),o=Date.parse(t.date.toString());return n<o?1:n>o?-1:0})),e.slice(0,7)}}}));pt.render=ft,pt.__scopeId="data-v-23929ce5";var bt=pt,ht=Object(o["y"])("data-v-05a2445b");Object(o["k"])("data-v-05a2445b");var mt={class:"form-holder topic-form"},gt={class:"nes-field"},Ot=Object(o["f"])("label",{for:"command_syntax"}," Command Syntax ",-1),jt=Object(o["f"])("div",null,[Object(o["f"])("i",null,[Object(o["e"])("You need to use "),Object(o["f"])("code",null,"{name}"),Object(o["e"])(" and "),Object(o["f"])("code",null,"{content}"),Object(o["e"])(" to replace your commands. ")])],-1),vt=Object(o["f"])("br",null,null,-1);Object(o["i"])();var wt=ht((function(e,t,n,c,r,a){return Object(o["h"])(),Object(o["c"])("div",mt,[Object(o["f"])("div",gt,[Ot,Object(o["v"])(Object(o["f"])("input",{type:"text",id:"command_syntax",class:"nes-input",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.commandSyntax=t})},null,512),[[o["s"],e.commandSyntax]]),jt]),vt,Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:t[2]||(t[2]=function(t){return e.cancel()})},"Cancel"),Object(o["f"])("button",{type:"button",class:"nes-btn",onClick:t[3]||(t[3]=function(t){return e.save()})},"Save")])})),kt=Object(o["g"])({data:function(){return{state:$.state,commandSyntax:""}},mounted:function(){this.commandSyntax=E[P]},computed:{},methods:{cancel:function(){this.$emit("cancel")},save:function(){localStorage.setItem(P,this.commandSyntax),E[P]=this.commandSyntax,this.$emit("save")}}});kt.render=wt,kt.__scopeId="data-v-05a2445b";var yt,Tt=kt;function It(e){return new Promise((function(t){return setTimeout(t,e)}))}var Ct=new URLSearchParams(null===(yt=location.hash)||void 0===yt?void 0:yt.replace("#","")),xt=function(e){Object(_["a"])(n,e);var t=Object(N["a"])(n);function n(){var e;return Object(x["a"])(this,n),e=t.apply(this,arguments),e.state=$.state,e.startAnimate=!1,e.authRedirectMode=Ct.has("id_token"),e.loggedIn=!1,e.userName="",e.showHistory=!1,e.showOptions=!1,e.showNewForm=!1,e.formForTopic=Object(o["l"])(null),e}return Object(S["a"])(n,[{key:"mounted",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.authRedirectMode&&Ee.checkTokens(),e.next=3,Ee.loginExists();case 3:if(t=e.sent,console.info({loginResult:t}),!t){e.next=14;break}if(this.loggedIn=!!(null===t||void 0===t?void 0:t.preferred_username),this.loggedIn){e.next=11;break}return this.loggedIn=!1,Ee.resetAuth(),e.abrupt("return");case 11:this.userName=t.preferred_username,e.next=15;break;case 14:this.loggedIn=!1;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onAddNew",value:function(e){$.addTopic(e),this.showNewForm=!1}},{key:"deleteTopic",value:function(e){window.confirm("Delete this topic?")&&$.deleteTopic(e)}},{key:"showEditForm",value:function(e){console.info({topic:e}),this.formForTopic=e}},{key:"editTopic",value:function(e){console.info({topic:e}),$.editTopic(e),this.formForTopic=null}},{key:"increaseCounter",value:function(e){e.currentCounter++,$.editTopic(e),console.info("Push title to Twitch: ",Object(I["a"])({},e))}},{key:"setupTwitch",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(t){var n,o,c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return $.addHistoryEntry({task:"Applied ".concat(t.title,": ").concat(t.currentCounter),lastTitle:ye(t),topicId:null!==(n=t.id)&&void 0!==n?n:-1,lastCounter:t.currentCounter}),e.next=3,Ee.applyTopicToTwitch(t);case 3:o=Object(T["a"])(t.commands),e.prev=4,o.s();case 6:if((c=o.n()).done){e.next=14;break}return r=c.value,e.next=10,Ee.writeToChat(r);case 10:return e.next=12,It(1e3);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](4),o.e(e.t0);case 19:return e.prev=19,o.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[4,16,19,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getToken",value:function(){var e=Object(C["a"])(regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ee.login();case 2:t=e.sent,n=t.userId,o=t.userName,n&&(this.loggedIn=!0,this.userName=o);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){Ee.resetAuth(),this.loggedIn=!1,this.userName=""}}]),n}(R["b"]);xt=Object(A["a"])([Object(R["a"])({components:{TopicForm:Le,ClosablePanel:ze,TopicEntry:ut,HistoryList:bt,OptionsVue:Tt}})],xt);var St=xt;n("9cdc");St.render=k;var _t=St,Nt=n("9483");Object(Nt["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),Object(o["b"])(_t).mount("#app")},d36d:function(e,t,n){},ecbb:function(e,t,n){}});
//# sourceMappingURL=app.d9cae2b9.js.map