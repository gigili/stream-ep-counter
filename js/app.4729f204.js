(function(t){function e(e){for(var o,a,i=e[0],s=e[1],u=e[2],d=0,p=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&p.push(c[a][0]),c[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);l&&l(e);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,i=1;i<n.length;i++){var s=n[i];0!==c[s]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},c={app:0},r=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=s;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},1:function(t,e){},"1cdc3":function(t,e,n){"use strict";n("6940")},2:function(t,e){},6940:function(t,e,n){},"6df6":function(t,e,n){"use strict";n("b349")},"9cdc":function(t,e,n){"use strict";n("c701")},b349:function(t,e,n){},b3b1:function(t,e,n){"use strict";n("ecbb")},c701:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),c={key:0},r={key:1},a={class:"flex-holder"},i={class:"column"},s={class:"scrolling-holder "},u={class:"nes-container is-rounded is-dark with-title"},l=Object(o["f"])("p",{class:"title"},"Stream Topics",-1),d={class:"scrolling-content"},p={class:"nes-container is-rounded is-dark"},f={class:"column"},b={key:0,class:"nes-container is-rounded is-dark with-title"},h=Object(o["f"])("p",{class:"title"},"New Topic",-1),m={key:1,class:"nes-container is-rounded is-dark with-title"},g={class:"title"},O={key:2,class:"nes-container is-rounded is-dark with-title"},j=Object(o["f"])("p",{class:"title"},"Changed history:",-1),v={key:3,class:"nes-container is-rounded is-dark with-title"},w=Object(o["f"])("p",{class:"title"},"Options:",-1);function T(t,e,n,T,k,y){var I=Object(o["p"])("topic-entry"),x=Object(o["p"])("topic-form"),C=Object(o["p"])("closable-panel"),S=Object(o["p"])("history-list"),_=Object(o["p"])("options-vue");return t.authRedirectMode?(Object(o["h"])(),Object(o["c"])("div",c," HI, You were authenticated, this window will close in 4 Seconds :) ")):(Object(o["h"])(),Object(o["c"])("div",r,[Object(o["f"])("a",{class:"github-link",href:"https://github.com/negue/stream-ep-counter",target:"_blank",rel:"noopener",onMouseover:e[1]||(e[1]=function(e){return t.startAnimate=!0}),onMouseout:e[2]||(e[2]=function(e){return t.startAnimate=!1})},[Object(o["f"])("i",{class:["nes-octocat",t.startAnimate?"animate":""]},null,2)],32),Object(o["f"])("div",a,[Object(o["f"])("div",i,[Object(o["f"])("div",s,[Object(o["f"])("div",u,[l,Object(o["f"])("div",null,[Object(o["f"])("button",{type:"button",class:"nes-btn is-primary",onClick:e[3]||(e[3]=function(e){return t.showNewForm=!t.showNewForm})}," Add new topic "),Object(o["f"])("button",{type:"button",class:"nes-btn is-primary",onClick:e[4]||(e[4]=function(e){return t.showHistory=!t.showHistory})}," Toggle History "),Object(o["f"])("button",{type:"button",class:"nes-btn is-primary",onClick:e[5]||(e[5]=function(e){return t.showOptions=!t.showOptions})}," Toggle Options "),t.loggedIn?Object(o["d"])("",!0):(Object(o["h"])(),Object(o["c"])("button",{key:0,onClick:e[6]||(e[6]=function(e){return t.getToken()}),class:"nes-btn is-success"},"Twitch Auth"))])]),Object(o["f"])("div",d,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(t.state.topics,(function(n){return Object(o["h"])(),Object(o["c"])("div",{key:n.id},[Object(o["f"])("div",p,[Object(o["f"])("div",null,[Object(o["f"])(I,{topic:n,loggedIn:t.loggedIn,onShowEditForm:e[7]||(e[7]=function(e){return t.showEditForm(e)}),onDeleteTopic:e[8]||(e[8]=function(e){return t.deleteTopic(e)}),onIncreaseCounter:e[9]||(e[9]=function(e){return t.increaseCounter(e)}),onSetupTwitch:e[10]||(e[10]=function(e){return t.setupTwitch(e)})},null,8,["topic","loggedIn"])])])])})),128))])])]),Object(o["f"])("div",f,[t.showNewForm?(Object(o["h"])(),Object(o["c"])("div",b,[h,Object(o["f"])(C,{onCancel:e[12]||(e[12]=function(e){return t.showNewForm=!1})},{default:Object(o["t"])((function(){return[Object(o["f"])(x,{onSave:t.onAddNew,onCancel:e[11]||(e[11]=function(e){return t.showNewForm=!1}),loggedIn:t.loggedIn},null,8,["onSave","loggedIn"])]})),_:1})])):Object(o["d"])("",!0),t.formForTopic?(Object(o["h"])(),Object(o["c"])("div",m,[Object(o["f"])("p",g,"Edit Topic: "+Object(o["q"])(t.formForTopic.title),1),Object(o["f"])(C,{onCancel:e[14]||(e[14]=function(e){return t.formForTopic=void 0})},{default:Object(o["t"])((function(){return[Object(o["f"])(x,{topic:t.formForTopic,onSave:t.editTopic,onCancel:e[13]||(e[13]=function(e){return t.formForTopic=void 0}),loggedIn:t.loggedIn},null,8,["topic","onSave","loggedIn"])]})),_:1})])):Object(o["d"])("",!0),t.showHistory?(Object(o["h"])(),Object(o["c"])("div",O,[j,Object(o["f"])(C,{onCancel:e[15]||(e[15]=function(e){return t.showHistory=!1})},{default:Object(o["t"])((function(){return[Object(o["f"])(S)]})),_:1})])):Object(o["d"])("",!0),t.showOptions?(Object(o["h"])(),Object(o["c"])("div",v,[w,Object(o["f"])(C,{onCancel:e[17]||(e[17]=function(e){return t.showOptions=!1})},{default:Object(o["t"])((function(){return[Object(o["f"])(_,{onCancel:e[16]||(e[16]=function(e){return t.showOptions=!1})})]})),_:1})])):Object(o["d"])("",!0)])])]))}n("99af"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d");var k,y=n("b85c"),I=n("5530"),x=(n("96cf"),n("1da1")),C=n("d4ec"),S=n("bee2"),_=n("262e"),N=n("2caf"),R=n("9ab4"),A=n("ce1f"),F=(n("c740"),n("c975"),n("a15b"),n("d81d"),n("a434"),n("ade3")),U="{name}",P="{content}",q="commandSyntax",E=Object(F["a"])({},q,null!==(k=localStorage.getItem(q))&&void 0!==k?k:"!editcommand ".concat(U," ").concat(P)),D={currentCounter:1,title:"",template:"",tags:"",commands:[],commandsJson:"[]"},H={task:"",lastCounter:0,topicId:-1,lastTitle:""},J=n("257e"),L=n("4dec"),V=function(t){Object(_["a"])(n,t);var e=Object(N["a"])(n);function n(){var t;Object(C["a"])(this,n),t=e.call(this,"StreamEpCounter");var o=Object(J["a"])(t);return o.version(5).stores({topics:"++id, currentCounter, title, template, gameId, gameName, tags, commandsJson",history:"++id, date, task",tags:"id, name"}),t}return n}(L["a"]),$=new V,B={state:Object(o["l"])({topics:[],history:[],tags:{}}),loadDataFromDb:function(){$.topics.toArray().then((function(t){var e,n=Object(y["a"])(t);try{for(n.s();!(e=n.n()).done;){var o,c=e.value;c.commands=JSON.parse(null!==(o=c.commandsJson)&&void 0!==o?o:"[]")}}catch(r){n.e(r)}finally{n.f()}B.state.topics=t})),$.history.toArray().then((function(t){B.state.history=t})),$.tags.toArray().then((function(t){var e,n=Object(y["a"])(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;B.state.tags[o.id]=o}}catch(c){n.e(c)}finally{n.f()}}))},addTopic:function(t){var e=Object.assign({},D,t),n=e.commands;e.commandsJson=JSON.stringify(e.commands),delete e.commands,this.importTagsAndUpdateTagIdList(e),this.state.topics.push(e),console.info("pre calling topic add"),$.topics.add(e),e.commands=n},deleteTopic:function(t){var e=this.state.topics.indexOf(t);-1!==e&&this.state.topics.splice(e,1),$.topics.delete(t.id)},editTopic:function(t){var e=this.state.topics.findIndex((function(e){return e.id===t.id})),n=Object.assign({},t),o=n.commands;n.commandsJson=JSON.stringify(n.commands),delete n.commands,this.importTagsAndUpdateTagIdList(n),-1!==e&&(this.state.topics[e]=n,console.info("updated in state?!",this.state)),console.info("pre calling topic update"),$.topics.update(t.id,n),n.commands=o},addHistoryEntry:function(t){var e=Object.assign({date:new Date},H,t);this.state.history.push(e),$.history.add(e)},importTagsAndUpdateTagIdList:function(t){var e,n;t.importTags&&(this.importUnknownTags(t.importTags),t.tags=null!==(e=null===(n=t.importTags)||void 0===n?void 0:n.map((function(t){return t.id})).join(","))&&void 0!==e?e:"",delete t.importTags)},importUnknownTags:function(t){var e,n=Object(y["a"])(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(!this.state.tags[o.id]){this.state.tags[o.id]=o;var c=Object.assign({},o);console.info("PRE adding a tag",o),$.tags.add(c)}}}catch(r){n.e(r)}finally{n.f()}}};B.loadDataFromDb();n("caad"),n("fb6a"),n("b0c0"),n("2532");var z=Object(o["x"])("data-v-194abd48");Object(o["k"])("data-v-194abd48");var M={class:"form-holder topic-form"},X={class:"nes-field"},Y=Object(o["f"])("label",{for:"name_field"}," Topic ",-1),G={class:"nes-field"},W=Object(o["f"])("label",{for:"counter_field"},"Counter",-1),K={class:"nes-field"},Q=Object(o["f"])("label",{for:"textarea_field"},"Title-Template",-1),Z={key:0},tt=Object(o["e"])("You need to use "),et=Object(o["e"])(" as placeholder. "),nt={key:1,class:"nes-text is-error"},ot={class:"nes-field"},ct=Object(o["f"])("label",null,"In Twitch Overview",-1),rt={class:"nes-text is-warning"},at={class:"nes-field"},it=Object(o["f"])("label",null,"Tags",-1),st={class:"nes-field"},ut=Object(o["e"])(" Commands "),lt=Object(o["f"])("br",null,null,-1),dt=Object(o["f"])("br",null,null,-1),pt={key:0},ft=Object(o["f"])("br",null,null,-1),bt=Object(o["f"])("br",null,null,-1),ht=Object(o["f"])("br",null,null,-1),mt=Object(o["f"])("br",null,null,-1),gt=Object(o["f"])("br",null,null,-1),Ot=Object(o["f"])("br",null,null,-1);Object(o["i"])();var jt=z((function(t,e,n,c,r,a){var i,s=Object(o["p"])("tags-input");return Object(o["h"])(),Object(o["c"])("div",M,[Object(o["f"])("div",X,[Y,Object(o["u"])(Object(o["f"])("input",{type:"text",id:"name_field",class:["nes-input",{"is-error":!t.workingTopic.title}],required:!t.workingTopic.title,autocomplete:"off","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.workingTopic.title=e})},null,10,["required"]),[[o["r"],t.workingTopic.title]])]),Object(o["f"])("div",G,[W,Object(o["u"])(Object(o["f"])("input",{type:"number",id:"counter_field",class:"nes-input",autocomplete:"off","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.workingTopic.currentCounter=e})},null,512),[[o["r"],t.workingTopic.currentCounter]])]),Object(o["f"])("div",K,[Q,Object(o["u"])(Object(o["f"])("textarea",{id:"textarea_field",class:"nes-textarea","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.workingTopic.template=e})},null,512),[[o["r"],t.workingTopic.template]]),(null===(i=t.workingTopic.template)||void 0===i?void 0:i.includes("{{counter}}"))?Object(o["d"])("",!0):(Object(o["h"])(),Object(o["c"])("div",Z,[Object(o["f"])("i",null,[tt,Object(o["f"])("code",null,Object(o["q"])(t.counterPlaceholder),1),et])])),t.isTemplateInvalid?(Object(o["h"])(),Object(o["c"])("span",nt,Object(o["q"])(t.notValidExplanation),1)):Object(o["d"])("",!0)]),Object(o["f"])("div",ot,[ct,Object(o["f"])("span",rt,Object(o["q"])(t.generatedTitle.slice(0,32)),1)]),Object(o["f"])("div",at,[it,Object(o["f"])(s,{"element-id":"tags",ref:"tagsInput",value:t.currentTags,onTagsUpdated:e[4]||(e[4]=function(e){return t.updateTags(e)}),"only-existing-tags":!0,"id-field":"id","text-field":"name","existing-tags":t.allTags,typeahead:!0,placeholder:"Select tags","typeahead-activation-threshold":0},{"selected-tag":z((function(t){var e=t.tag,n=t.index,c=t.removeTag;return[Object(o["e"])(Object(o["q"])(e.name)+" ",1),Object(o["f"])("span",{class:"is-danger",onClick:Object(o["w"])((function(t){return c(n)}),["prevent"])},"X",8,["onClick"])]})),_:1},8,["value","existing-tags"])]),Object(o["f"])("div",st,[Object(o["f"])("label",null,[ut,Object(o["f"])("button",{type:"button",class:"nes-btn",onClick:e[5]||(e[5]=function(e){return t.addCommand()})},"Add new command")]),(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(t.workingTopic.commands,(function(e,n){return Object(o["h"])(),Object(o["c"])("div",{key:n,class:"command_item"},[Object(o["u"])(Object(o["f"])("input",{type:"text",class:"nes-input",autocomplete:"off","onUpdate:modelValue":function(t){return e.name=t}},null,8,["onUpdate:modelValue"]),[[o["r"],e.name]]),Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:function(e){return t.removeCommand(n)}},"X",8,["onClick"]),lt,Object(o["u"])(Object(o["f"])("textarea",{class:"nes-textarea","onUpdate:modelValue":function(t){return e.content=t}},null,8,["onUpdate:modelValue"]),[[o["r"],e.content]])])})),128))]),dt,t.workingTopic.gameName||t.workingTopic.tags?(Object(o["h"])(),Object(o["c"])("div",pt,[ft,Object(o["e"])(" Game: "+Object(o["q"])(t.workingTopic.gameName)+" ",1),bt,ht])):Object(o["d"])("",!0),mt,Object(o["f"])("button",{type:"button",class:["nes-btn",{"is-is-error":t.loggedIn,"is-disabled":!t.loggedIn}],onClick:e[6]||(e[6]=function(e){return t.importFromTwitch()})},"Import from Twitch",2),gt,Ot,Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:e[7]||(e[7]=function(e){return t.cancel()})},"Cancel"),Object(o["f"])("button",{type:"button",class:"nes-btn",onClick:e[8]||(e[8]=function(e){return t.save()})},"Save")])})),vt=(n("4de4"),n("07ac"),n("1276"),n("2909"));n("841c"),n("4c53");function wt(t){return t&&t.template?t.template.replace(/{{counter}}/g,"".concat(t.currentCounter)):""}function Tt(t){var e=E[q].replace(U,t.name).replace(P,t.content);return e}var kt=n("1232"),yt=n("3cba"),It=function(){function t(e,n,o){Object(C["a"])(this,t),this.clientId=e,this.scopes=n,this.redirectUrl=o,this.twitchAuthUrl="https://id.twitch.tv/oauth2/authorize?response_type=token%20id_token&client_id=".concat(this.clientId,"&redirect_uri=").concat(encodeURIComponent(this.redirectUrl),"&scope=").concat(this.scopes,"+openid"),this.tmi=null}return Object(S["a"])(t,[{key:"login",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var o,c=null!==(o=localStorage.getItem("userId"))&&void 0!==o?o:"";if(c){var r,a,i,s=null!==(r=localStorage.getItem("userName"))&&void 0!==r?r:"",u=null!==(a=localStorage.getItem("tokenId"))&&void 0!==a?a:"",l=null!==(i=localStorage.getItem("accessToken"))&&void 0!==i?i:"";t({userId:c,userName:s,tokenId:u,accessToken:l})}else window.open(e.twitchAuthUrl,"Twitch Auth","toolbar=0,scrollbars=1,status=1,resizable=1,location=1,menuBar=0"),console.info(e.twitchAuthUrl),window.gotToken=function(e,n,o,c){console.info({userName:e,userId:n,tokenId:o,accessToken:c}),t({userName:e,userId:n,tokenId:o,accessToken:c}),localStorage.setItem("userName",e),localStorage.setItem("userId",n),localStorage.setItem("tokenId",o),localStorage.setItem("accessToken",c)}})));case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"loginExists",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("accessToken"),e){t.next=3;break}return t.abrupt("return",null);case 3:return t.abrupt("return",fetch("https://id.twitch.tv/oauth2/userinfo",{headers:{Authorization:"Bearer ".concat(e)}}).then((function(t){return t.json()})).then((function(t){return console.info({js:t}),t})));case 4:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"checkTokens",value:function(){console.info({location:location});var t=location.hash.replace("#",""),e=new URLSearchParams(t),n=e.get("id_token"),o=e.get("access_token"),c=Object(kt["a"])(n);console.info({jwt:c});var r=c.preferred_username,a=c.sub;console.info({userName:r,userId:a,tokenId:n,accessToken:o}),setTimeout((function(){window.opener.gotToken(r,a,n,o),window.close()}),4e3)}},{key:"currentChannelInformation",value:function(){return fetch("https://api.twitch.tv/helix/channels?broadcaster_id="+localStorage.getItem("userId"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId}}).then((function(t){return t.json()})).then((function(t){return console.info({js:t}),t.data[0]}))}},{key:"currentTags",value:function(){return fetch("https://api.twitch.tv/helix/streams/tags?broadcaster_id="+localStorage.getItem("userId"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId}}).then((function(t){return t.json()})).then((function(t){return console.info({js:t}),t.data}))}},{key:"applyTopicToTwitch",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(e){var n,o,c,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=localStorage.getItem("userId"),c={tag_ids:null===(n=e.tags)||void 0===n?void 0:n.split(",")},t.next=4,fetch("https://api.twitch.tv/helix/streams/tags?broadcaster_id="+o,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId,"content-type":"application/json"},method:"PUT",body:JSON.stringify(c)});case 4:return r={game_id:e.gameId,title:wt(e),broadcaster_language:"en"},t.next=7,fetch("https://api.twitch.tv/helix/channels?broadcaster_id="+o,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"client-id":this.clientId,"content-type":"application/json"},method:"PATCH",body:JSON.stringify(r)});case 7:console.info("Apply values to Twitch",{broadcaster_id:o,newTagsPayload:c,channelInformationPayload:r});case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"writeToChat",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(e){var n,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=null!==(n=localStorage.getItem("userName"))&&void 0!==n?n:"",null!==this.tmi){t.next=7;break}return this.tmi=yt["Client"]({identity:{username:o,password:"oauth:".concat(localStorage.getItem("accessToken"))},connection:{secure:!0,reconnect:!0}}),t.next=5,this.tmi.connect();case 5:c=t.sent,console.info({result:c,userName:o});case 7:return t.next=9,this.tmi.say(o,Tt(e));case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),xt=function(){function t(){Object(C["a"])(this,t)}return Object(S["a"])(t,[{key:"login",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",{accessToken:"",tokenId:"",userName:"",userId:""});case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"loginExists",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",{preferred_username:"offfline"});case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"checkTokens",value:function(){}},{key:"currentChannelInformation",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",{title:"Stuff",game_id:"1334",game_name:"Coding Stuff"});case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"currentTags",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",[]);case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"applyTopicToTwitch",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:alert("Stuff will be applied to Twitch");case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"writeToChat",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:alert("Writing to chat that!"+Tt(e));case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),Ct="".concat(location.href),St="user_read+user:edit:broadcast+chat:read+chat:edit",_t="mz7t3tiaptc51q5rvp5e86j51e61p5",Nt=new URLSearchParams(location.search);console.info({queryParams:Nt});var Rt=Nt.has("develop")?new xt:new It(_t,St,Ct),At=n("0b72"),Ft=Object(o["g"])({components:{TagsInput:At["a"]},props:{topic:{type:Object,required:!0},loggedIn:{type:Boolean}},data:function(){return{workingTopic:Object(I["a"])({},this.topic),counterPlaceholder:"{{counter}}",currentTags:[],state:B.state}},computed:{allTags:function(){var t,e=Object(vt["a"])(Object.values(this.state.tags));return(null===(t=this.workingTopic)||void 0===t?void 0:t.importTags)&&e.push.apply(e,Object(vt["a"])(this.workingTopic.importTags)),e},generatedTitle:function(){return wt(Object(I["a"])({},this.workingTopic))},isTemplateInvalid:function(){return""!==this.notValidExplanation},notValidExplanation:function(){var t=this.workingTopic.template;if(!t)return"You need a template.";var e=wt(Object(I["a"])(Object(I["a"])({},this.workingTopic),{},{currentCounter:100})),n=e.length;return n>140?"A generated topic can be only 140 characters long. (Using 100 as counter) - Current Length: ".concat(n):""}},methods:{cancel:function(){this.$emit("cancel")},save:function(){this.workingTopic.title&&(this.isTemplateInvalid||this.$emit("save",this.workingTopic))},importFromTwitch:function(){var t=this;return Object(x["a"])(regeneratorRuntime.mark((function e(){var n,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Rt.currentChannelInformation();case 2:return n=e.sent,e.next=5,Rt.currentTags();case 5:o=e.sent,t.workingTopic.template||(t.workingTopic.template=n.title),t.workingTopic.gameId=n.game_id,t.workingTopic.gameName=n.game_name,console.info({channelInfo:n,tags:o}),c=o.filter((function(t){return!t.is_auto})).map((function(t){return{id:t.tag_id,name:t.localization_names["en-us"]}})),console.info({tags:o,importedTags:c}),t.workingTopic.importTags=c,t.currentTags=c;case 14:case"end":return e.stop()}}),e)})))()},updateTagsFromTopic:function(){var t,e,n,o=this;console.info({topic:this.workingTopic,state:null!==(t=JSON.stringify(this.state.tags))&&void 0!==t?t:"no null value",test:!0}),this.currentTags=null!==(e=null===(n=this.workingTopic.tags)||void 0===n?void 0:n.split(",").map((function(t){return o.state.tags[t]})).filter((function(t){return!!t})))&&void 0!==e?e:[],this.updateTagsToTopic()},updateTags:function(){var t=this.$refs.tagsInput.tags;this.currentTags=t,console.info(this.$refs),console.info("SHOULD BE UPDATED?!!?",this.currentTags),this.updateTagsToTopic()},updateTagsToTopic:function(){this.workingTopic.tags=this.currentTags.map((function(t){return t.id})).join(",")},addCommand:function(){this.workingTopic.commands.push({name:"New Command",content:""})},removeCommand:function(t){this.workingTopic.commands.splice(t,1)}},watch:{topic:function(t){this.workingTopic=Object(I["a"])({},t),this.updateTagsFromTopic()}},mounted:function(){this.updateTagsFromTopic()}});n("1cdc3"),n("6df6");Ft.render=jt,Ft.__scopeId="data-v-194abd48";var Ut=Ft,Pt=Object(o["x"])("data-v-203cd942");Object(o["k"])("data-v-203cd942");var qt={class:"panel-holder"};Object(o["i"])();var Et=Pt((function(t,e,n,c,r,a){return Object(o["h"])(),Object(o["c"])("div",qt,[Object(o["o"])(t.$slots,"default"),Object(o["f"])("button",{type:"button",class:"nes-btn is-error floating-close-button",onClick:e[1]||(e[1]=function(t){return a.cancel()})},"X")])})),Dt={name:"ClosablePanel",methods:{cancel:function(){this.$emit("cancel")}}};n("b3b1");Dt.render=Et,Dt.__scopeId="data-v-203cd942";var Ht=Dt,Jt=Object(o["x"])("data-v-29a573c2");Object(o["k"])("data-v-29a573c2");var Lt={class:"nes-text is-warning"},Vt=Object(o["f"])("br",null,null,-1),$t=Object(o["f"])("br",null,null,-1),Bt=Object(o["f"])("br",null,null,-1),zt=Object(o["e"])(" Tags: "),Mt={key:0},Xt={class:"is-primary"},Yt={key:1},Gt=Object(o["f"])("br",null,null,-1),Wt=Object(o["f"])("br",null,null,-1),Kt={class:"nes-text is-success"},Qt=Object(o["e"])(),Zt=Object(o["f"])("br",null,null,-1);Object(o["i"])();var te=Jt((function(t,e,n,c,r,a){var i,s;return Object(o["h"])(),Object(o["c"])(o["a"],null,[Object(o["f"])("h4",null,[Object(o["e"])(Object(o["q"])(t.topic.title)+" ["+Object(o["q"])(t.topic.currentCounter)+"] ",1),Object(o["f"])("button",{type:"button",class:"nes-btn is-warning",onClick:e[1]||(e[1]=function(e){return t.$emit("show-edit-form",t.topic)})},"Edit"),Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:e[2]||(e[2]=function(e){return t.$emit("delete-topic",t.topic)})},"X")]),Object(o["f"])("h5",null,[Object(o["f"])("span",Lt,Object(o["q"])(t.generateTitle(t.topic).slice(0,32)),1),Object(o["e"])(Object(o["q"])(t.generateTitle(t.topic).slice(32))+" ",1),Vt]),$t,Object(o["e"])(" Game: "+Object(o["q"])(null!==(i=t.topic.gameName)&&void 0!==i?i:'Need to "Import from Twitch"')+" ",1),Bt,zt,t.topic.tags?(Object(o["h"])(),Object(o["c"])("span",Mt,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(null===(s=t.topic.tags)||void 0===s?void 0:s.split(",").map((function(e){var n;return null===(n=t.state.tags[e])||void 0===n?void 0:n.name})),(function(t){return Object(o["h"])(),Object(o["c"])("span",{class:"nes-badge",key:t},[Object(o["f"])("span",Xt,Object(o["q"])(t),1)])})),128))])):Object(o["d"])("",!0),t.topic.tags?Object(o["d"])("",!0):(Object(o["h"])(),Object(o["c"])("span",Yt,' Need to "Import from Twitch" ')),Gt,Wt,Object(o["f"])("span",Kt,Object(o["q"])(t.lastAppliedLabel),1),Qt,Zt,Object(o["f"])("button",{type:"button",class:"nes-btn is-warning",onClick:e[3]||(e[3]=function(e){return t.$emit("increase-counter",t.topic)})},"Increase Counter"),Object(o["f"])("button",{type:"button",class:["nes-btn",{"is-success":t.loggedIn,"is-disabled":!t.loggedIn}],onClick:e[4]||(e[4]=function(e){return t.$emit("setup-twitch",t.topic)})},"Set Twitch Title & Tags",2)],64)})),ee=(n("a9e3"),Object(o["g"])({props:{topic:{type:Object,required:!0},loggedIn:{type:Boolean}},data:function(){return{state:B.state}},computed:{lastAppliedLabel:function(){var t=this,e=this.state.history.filter((function(e){return e.topicId===t.topic.id}));if(e.length>0){e.sort((function(t,e){return t.date&&e.date?Number(new Date(e.date))-Number(new Date(t.date)):0}));var n=e[0];return"".concat(new Date(n.date).toLocaleString()," with the Title:  ").concat(n.lastTitle)}return console.info({foundEntriesInHistory:e}),""}},methods:{generateTitle:function(t){return wt(t)}}}));ee.render=te,ee.__scopeId="data-v-29a573c2";var ne=ee,oe=Object(o["x"])("data-v-23929ce5");Object(o["k"])("data-v-23929ce5");var ce={key:0};Object(o["i"])();var re=oe((function(t,e,n,c,r,a){return Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["n"])(t.sortedHistory,(function(t,e){return Object(o["h"])(),Object(o["c"])("div",{key:t.id},[0!==e?(Object(o["h"])(),Object(o["c"])("hr",ce)):Object(o["d"])("",!0),Object(o["f"])("h4",null,Object(o["q"])(t.task),1),Object(o["e"])(" "+Object(o["q"])(new Date(t.date).toLocaleString()),1)])})),128)})),ae=(n("25f0"),Object(o["g"])({data:function(){return{state:B.state}},computed:{sortedHistory:function(){var t=Object(vt["a"])(this.state.history);return t.sort((function(t,e){var n=Date.parse(t.date.toString()),o=Date.parse(e.date.toString());return n<o?1:n>o?-1:0})),t.slice(0,7)}}}));ae.render=re,ae.__scopeId="data-v-23929ce5";var ie=ae,se=Object(o["x"])("data-v-05a2445b");Object(o["k"])("data-v-05a2445b");var ue={class:"form-holder topic-form"},le={class:"nes-field"},de=Object(o["f"])("label",{for:"command_syntax"}," Command Syntax ",-1),pe=Object(o["f"])("div",null,[Object(o["f"])("i",null,[Object(o["e"])("You need to use "),Object(o["f"])("code",null,"{name}"),Object(o["e"])(" and "),Object(o["f"])("code",null,"{content}"),Object(o["e"])(" to replace your commands. ")])],-1),fe=Object(o["f"])("br",null,null,-1);Object(o["i"])();var be=se((function(t,e,n,c,r,a){return Object(o["h"])(),Object(o["c"])("div",ue,[Object(o["f"])("div",le,[de,Object(o["u"])(Object(o["f"])("input",{type:"text",id:"command_syntax",class:"nes-input",autocomplete:"off","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.commandSyntax=e})},null,512),[[o["r"],t.commandSyntax]]),pe]),fe,Object(o["f"])("button",{type:"button",class:"nes-btn is-error",onClick:e[2]||(e[2]=function(e){return t.cancel()})},"Cancel"),Object(o["f"])("button",{type:"button",class:"nes-btn",onClick:e[3]||(e[3]=function(e){return t.save()})},"Save")])})),he=Object(o["g"])({data:function(){return{state:B.state,commandSyntax:""}},mounted:function(){this.commandSyntax=E[q]},computed:{},methods:{cancel:function(){this.$emit("cancel")},save:function(){localStorage.setItem(q,this.commandSyntax),E[q]=this.commandSyntax,this.$emit("save")}}});he.render=be,he.__scopeId="data-v-05a2445b";var me,ge=he;function Oe(t){return new Promise((function(e){return setTimeout(e,t)}))}var je=new URLSearchParams(null===(me=location.hash)||void 0===me?void 0:me.replace("#","")),ve=function(t){Object(_["a"])(n,t);var e=Object(N["a"])(n);function n(){var t;return Object(C["a"])(this,n),t=e.apply(this,arguments),t.state=B.state,t.startAnimate=!1,t.authRedirectMode=je.has("id_token"),t.loggedIn=!0,t.showHistory=!1,t.showOptions=!1,t.showNewForm=!1,t.formForTopic=Object(o["l"])(null),t}return Object(S["a"])(n,[{key:"mounted",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.authRedirectMode&&Rt.checkTokens(),t.next=3,Rt.loginExists();case 3:e=t.sent,this.loggedIn=!!e&&!!(null===e||void 0===e?void 0:e.preferred_username);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onAddNew",value:function(t){B.addTopic(t),this.showNewForm=!1}},{key:"deleteTopic",value:function(t){window.confirm("Delete this topic?")&&B.deleteTopic(t)}},{key:"showEditForm",value:function(t){console.info({topic:t}),this.formForTopic=t}},{key:"editTopic",value:function(t){console.info({topic:t}),B.editTopic(t),this.formForTopic=null}},{key:"increaseCounter",value:function(t){t.currentCounter++,B.editTopic(t),console.info("Push title to Twitch: ",Object(I["a"])({},t))}},{key:"setupTwitch",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(e){var n,o,c,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return B.addHistoryEntry({task:"Applied ".concat(e.title,": ").concat(e.currentCounter),lastTitle:wt(e),topicId:null!==(n=e.id)&&void 0!==n?n:-1,lastCounter:e.currentCounter}),t.next=3,Rt.applyTopicToTwitch(e);case 3:o=Object(y["a"])(e.commands),t.prev=4,o.s();case 6:if((c=o.n()).done){t.next=14;break}return r=c.value,t.next=10,Rt.writeToChat(r);case 10:return t.next=12,Oe(1e3);case 12:t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](4),o.e(t.t0);case 19:return t.prev=19,o.f(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[4,16,19,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getToken",value:function(){var t=Object(x["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Rt.login();case 2:e=t.sent,n=e.userId,n&&(this.loggedIn=!0);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),n}(A["b"]);ve=Object(R["a"])([Object(A["a"])({components:{TopicForm:Ut,ClosablePanel:Ht,TopicEntry:ne,HistoryList:ie,OptionsVue:ge}})],ve);var we=ve;n("9cdc");we.render=T;var Te=we,ke=n("9483");Object(ke["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),Object(o["b"])(Te).mount("#app")},ecbb:function(t,e,n){}});
//# sourceMappingURL=app.4729f204.js.map